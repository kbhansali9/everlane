<!DOCTYPE html>
<html>
<head>
	<title>Inventory</title>
	<link rel='stylesheet' href='/style/mystyle.css'>
	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
  	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="https://checkout.stripe.com/checkout.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.3.js"></script>
</head>
<body>
	<div class="container">
		<a href="/">
				<img border="0" alt="W3Schools" src="https://d1qb2nb5cznatu.cloudfront.net/startups/i/47063-05f369b7b1527132ba05343f1b8ebb91-medium_jpg.jpg" width="100" height="100">
		</a> 

		<h1 id="cartPrice">Welcome to Everlane!</h1>
		<button onclick="checkout()" class="btn btn-success">Checkout</button>
		<br>
		<br>
		<br>

		<% for (item of items) { %>
			<img src="<%= item.image %>" height="300" width="300">
			<h2><%= item.name %></h2>
			<h5><%= item.category %></h5>
			<h3>$<%= item.price.toFixed(2) %></h3>
			<button onclick="addToCart('<%= item._id %>')" class="btn btn-success">add to cart</button><br>
			<br>
		<% } %>
	</div>
</body>
<script type="text/javascript">
	var cart = [];
	var inventory = <%- JSON.stringify(items) %>;

	function addToCart(item_id) {
		for (item of inventory) {
			if (item_id == item._id) {
				cart.push(item);
				break;
			}
		}

		var price = calculateSubtotal();
		document.getElementById("cartPrice").innerHTML = "Cart Price is: $" + price.toFixed(2);
	}

	function calculateSubtotal() {
		var subtotal = 0;
		for (item of cart) {
			subtotal += item.price;
		}
		return subtotal;
	}

	function checkout() {
		location.href = '/checkout?cart=' + JSON.stringify(cart);
	}

</script>
</html>