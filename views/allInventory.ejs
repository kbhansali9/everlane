<!DOCTYPE html>
<html>
<head>
	<title>Inventory</title>

	<script src="https://code.jquery.com/jquery-1.11.3.js"></script>
</head>
<body>

	<h1 id="cartPrice">Welcome to Everlane</h1>
	<button onclick="checkout()">Checkout</button>
	<br>
	<br>
	<br>

	<% for (item of items) { %>
		<img src="<%= item.image %>" height="300" width="300">
		<h2><%= item.name %></h2>
		<h5><%= item.category %></h5>
		<h3>$<%= item.price.toFixed(2) %></h3>
		<button onclick="addToCart('<%= item._id %>')">add to cart</button><br>
		<br>
	<% } %>

</body>
<script type="text/javascript">
	var cart = [];
	var inventory = <%- JSON.stringify(items) %>;

	function addToCart(item_id) {
		for (item of inventory) {
			if (item_id == item._id) {
				cart.push(item);
				break;
			}
		}

		var price = calculateSubtotal();
		document.getElementById("cartPrice").innerHTML = "Cart Price is: $" + price.toFixed(2);
	}

	function calculateSubtotal() {
		var subtotal = 0;
		for (item of cart) {
			subtotal += item.price;
		}
		return subtotal;
	}

	function checkout() {
		location.href = '/checkout?cart=' + JSON.stringify(cart);
	}

</script>
</html>